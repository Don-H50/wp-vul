0x01 Vulnerability description

    There is an XSS(Cross Site Scripting) vulerability in the wordpress plugin called CRM Perks Forms.
    An attacker inserts malicious javascript code into a web-page URL.
    The code is triggered when user clicks the malicious links and move his mouse over the list area on the left of the web-page. 

0x02 Recurrence of the vulnerability

    This is tne main page of the plugin.
    First, click Add-New-Form to create a new form.
![1.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-1.png)

    Choose one template.
![2.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-2.png)

    This is the affected page with XSS vulnerability.
    You can see that my new form id is 66, yours may be 1, it doesn't matter, cause I have created it many times.
    So the affected web-page URL is: http://127.0.0.1/wordpress/wp-admin/admin.php?page=cfx-form&form_id=66
    Statement: This URL can be used regardless of whether you have created a form, and the id can be any number.
![3.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-3.png)

    Payload: "onmouseover=alert(1)//
    Enter the payload in the URL bar and move your mouse over the list area on the left of the web-page, an alert pop-up will appear.
    So, there is an XSS vulnerability.
![4.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-4.png)

「EXP」

Purpose: By clicking on the malicious URL link constructed by the attacker and moving mouse, the user will leak his own cookie.
![5.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-5.png)


![6.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-6.png)


![7.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-7.png)


![8.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-8.png)


![9.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-9.png)


![10.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-10.png)


![11.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/0422-11.png)



![12.png](https://github.com/Don-H50/wp-vul/blob/main/images/CRM/2023-04-22_23-12.png)
   
    
