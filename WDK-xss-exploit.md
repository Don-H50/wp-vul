0x01 Vulnerability description

    There is an XSS(Cross Site Scripting) vulerability in the wordpress plugin called WP Directory Kit.
    An attacker inserts malicious code into a web-page URL.
    The code is triggered when user clicks the malicious links. 

0x02 Recurrence of the vulnerability

    This is tne main page of the plugin.
![1.png](https://github.com/Don-H50/wp-vul/blob/main/images/WDK/0426-1.png)

    This is the page with the XSS vulnerability.
    This XSS can be triggered by multiple payloads:"><img src/onerror=alert(1)> or "><svg/onload=alert(1)>
    When you enter payload in the search box，an alert pop-up will appear.
    So, there is an XSS vulnerability.
![2.png](https://github.com/Don-H50/wp-vul/blob/main/images/WDK/0426-2.png)

    At this point a new field is added to the URL of the page:'&search=', malicious code is added after field.
    And the affected web-page URL is: http://127.0.0.1/wordpress/wp-admin/admin.php?page=wdk_messages&search=
![3.png](https://github.com/Don-H50/wp-vul/blob/main/images/WDK/0426-3.png)

「EXP」

Purpose: By clicking on the malicious URL link constructed by the attacker and moving mouse, the user's page will load an image source.

    Change the payload to: "><svg/onload=alert(document.cookie)>
    We can see the user cookie information in the pop-up window.
![4.png](https://github.com/Don-H50/wp-vul/blob/main/images/WDK/0426-7.png)

    Build an image server locally to load an image for the user.
    The payload is "><img src/onerror=alert(1)>
    Change the payload to "><img src=http://exploit.com/0426.png>.
    merge the payload and URL to construct a malicious URL link.
    When the user clicks on the malicious link, his page will load image resources.
![5.png](https://github.com/Don-H50/wp-vul/blob/main/images/WDK/0426-8.png)
![6.png](https://github.com/Don-H50/wp-vul/blob/main/images/WDK/0426-9.png)



   
   
